{% extends 'bibtex/base.html' %}
{% block content %}

<script>
$(function() {
	$("#searchbutton").click(function() {
		postdata = {
				csrfmiddlewaretoken: "{{ csrf_token }}",
				term: $("#searchterm").val(),
		}
		if($('#search_author').is(':checked')) postdata.search_author = "true";
		if($('#search_title').is(':checked')) postdata.search_title = "true";
		if($('#search_all').is(':checked')) postdata.search_all = "true";

		fromyear = parseInt($("#fromyear").val())
		if(isNaN(fromyear)) {
			fromyear = {{fromyear}};
			$("#fromyear").val({{fromyear}});
		} else postdata.fromyear = fromyear;

		toyear = parseInt($("#toyear").val())
		if(isNaN(toyear)) {
			toyear = {{toyear}};
			$("#toyear").val({{toyear}});
		} else postdata.toyear = toyear;
		
		$.ajax({
			type: "POST",
			url: "{%url 'bibtex:getsearch' %}",
			data: postdata,
			success: function(data) {
				$("#searchresults").html(data)
			}
		})
	})
})
</script>



<h1>Search the database</h1>

<form>
<label>Search for: <input type="text" id="searchterm"></label>

<ul class="nobullets">
<li><label><input type="checkbox" id="search_author" checked="yes"> Author</label></li>
<li><label><input type="checkbox" id="search_title" checked="yes"> Title</label></li>
<li><label><input type="checkbox" id="search_all"> Entire entry</label></li>
</ul>
<p>
<label>From: <input type="text" id="fromyear" value="{{fromyear}}" size=4></label>
<label>To: <input type="text" id="toyear" value="{{toyear}}" size=4></label>
</p>
<span class="submit" id="searchbutton">Search</span>
</form>


<div id="searchresults"></div>

<p><a href="{% url 'bibtex:index' %}">Back</a></p>

{% endblock %}

